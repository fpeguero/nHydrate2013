//------------------------------------------------------------------------------
// <auto-generated>
//    This code was generated from a template.
//
//    Creador : Administrator
//    Dominio : OSISPC
//    Pc      : OSISPC
//    Fecha   : 6/19/2014 1:29:21 PM
//
//    Manual changes to this file may cause unexpected behavior in your application.
//    Manual changes to this file will be overwritten if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Data;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Reflection;
using System.IO;
using System.Data.Linq;
using System.Linq.Expressions;
using System.Data.SqlClient;
using OSIS.PEPPAM.BOM;
using nHydrate.EFCore.DataAccess;
using nHydrate.EFCore.Exceptions;

namespace OSIS.PEPPAM.BOM
{
	#region LinqSQLField

	[System.CodeDom.Compiler.GeneratedCode("nHydrateModelGenerator", "5.2.0")]
	internal class LinqSQLField
	{
		public string Name { get; set; }
		public string Alias { get; set; }
		public string Table { get; set; }

		public LinqSQLField(string name, string alias, string table)
		{
			this.Name = name.Replace("[", string.Empty).Replace("]", string.Empty);
			this.Alias = alias.Replace("[", string.Empty).Replace("]", string.Empty);
			this.Table = table.Replace("[", string.Empty).Replace("]", string.Empty);
		}

		public string GetSQL(bool useAlias)
		{
			if (useAlias)
				return "[" + this.Table + "].[" + this.Name + "] AS [" + this.Alias + "]";
			else
				return "[" + this.Table + "].[" + this.Name + "]";
		}

		public override string ToString()
		{
			return GetSQL(true);
		}

	}

	#endregion

	#region LinqSQLFromClause

	[System.CodeDom.Compiler.GeneratedCode("nHydrateModelGenerator", "5.2.0")]
	internal class LinqSQLFromClause
	{
		public string TableName { get; set; }
		public string Schema { get; set; }
		public string Alias { get; set; }
		public string LinkClause { get; set; }
		public string AnchorAlias { get; set; }

		public LinqSQLFromClause(string tableName, string schema, string alias, string linkClause)
		{
			this.AnchorAlias = string.Empty;
			this.Schema = schema;
			this.TableName = tableName.Replace("[", string.Empty).Replace("]", string.Empty);
			this.Alias = alias.Replace("[", string.Empty).Replace("]", string.Empty);
			this.LinkClause = linkClause;
		}
	}

	[System.CodeDom.Compiler.GeneratedCode("nHydrateModelGenerator", "5.2.0")]
	internal class LinqSQLFromClauseCollection : List<LinqSQLFromClause>
	{
		public bool ContainsTable(string tableName)
		{
			foreach (var item in this)
			{
				if (item.TableName == tableName) return true;
			}
			return false;
		}

		public LinqSQLFromClause GetByTable(string tableName)
		{
			foreach (var item in this)
			{
				if (item.TableName == tableName) return item;
			}
			return null;
		}

		public LinqSQLFromClause GetByAlias(string alias)
		{
			alias = alias.Replace("[", string.Empty).Replace("]", string.Empty);
			foreach (var item in this)
			{
				if (item.Alias == alias) return item;
			}
			return null;
		}

		public string GetBaseAliasTable(string parentAlias, string baseTable)
		{
			LinqSQLFromClause root = GetByAlias(parentAlias);
			foreach (var item in this)
			{
				if (item.AnchorAlias == root.TableName)
				{
					if (item.TableName == baseTable) return item.Alias;
				}
			}
			return parentAlias;
		}

		internal string NewAlias()
		{
			int index = 1;
			foreach (var item in this)
			{
				if (item.Alias.StartsWith("z"))
				{
					int current = int.Parse(item.Alias.Substring(1, item.Alias.Length - 1));
					if (current >= index) index = current + 1;
				}
			}
			return "z" + index;
		}

		internal void RemapFromClause()
		{
			//Remap the FROM clause
			foreach (var fromClause in this)
			{
				//Loop through all child tables and remap the "parent" fields to the real child fields
				if ((fromClause.AnchorAlias == string.Empty) && (!string.IsNullOrEmpty(fromClause.LinkClause)))
				{
					string s = fromClause.LinkClause.Substring(3, fromClause.LinkClause.Length - 3);
					string[] arr1 = s.Split('=');

					string[] tfield1 = arr1[0].Trim().Split('.');
					string[] tfield2 = arr1[1].Trim().Split('.');

					string tableAlias1 = tfield1[0];
					string table1 = this.GetByAlias(tableAlias1).TableName;
					string field1 = tfield1[1];

					string tableAlias2 = tfield2[0];
					string table2 = this.GetByAlias(tableAlias2).TableName;
					string field2 = tfield2[1];

					string realTable = string.Empty;

					realTable = GetRealTableName(table1, field1);
					if (realTable != table1)
					{
						string parentAlias = GetByTable(table2).Alias;
						string chlidAlias = GetByTable(realTable).Alias;
						fromClause.LinkClause = fromClause.LinkClause.Replace("[" + parentAlias + "]." + field2, "[" + chlidAlias + "]." + field2);
					}

					realTable = GetRealTableName(table2, field2);
					if (realTable != table2)
					{
						string parentAlias = GetByTable(table2).Alias;
						string chlidAlias = GetByTable(realTable).Alias;
						fromClause.LinkClause = fromClause.LinkClause.Replace("[" + parentAlias + "]." + field2, "[" + chlidAlias + "]." + field2);
					}

				}
			}
		}

		internal string GetRealTableName(string parentTable, string field)
		{
			field = field.Replace("[", string.Empty).Replace("]", string.Empty);
			string realTable = string.Empty;
			if (parentTable == "Circuitos_Cata") realTable = OSIS.PEPPAM.BOM.Circuitos_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Congregaciones_Master") realTable = OSIS.PEPPAM.BOM.Congregaciones_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Contacto_Tipo_Cata") realTable = OSIS.PEPPAM.BOM.Contacto_Tipo_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Dias_Cata") realTable = OSIS.PEPPAM.BOM.Dias_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Documentos_Master") realTable = OSIS.PEPPAM.BOM.Documentos_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Documentos_Objetivos_Trans") realTable = OSIS.PEPPAM.BOM.Documentos_Objetivos_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Experiencias_Master") realTable = OSIS.PEPPAM.BOM.Experiencias_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Horario_Semanas_Cata") realTable = OSIS.PEPPAM.BOM.Horario_Semanas_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Horario_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Horario_Turno_Dias_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Turno_Dias_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Horario_Turno_Informe_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Turno_Informe_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Horario_Turno_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Turno_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Horarios_Master") realTable = OSIS.PEPPAM.BOM.Horarios_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Horas_Cata") realTable = OSIS.PEPPAM.BOM.Horas_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Idiomas_Cata") realTable = OSIS.PEPPAM.BOM.Idiomas_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Notificaciones_Master") realTable = OSIS.PEPPAM.BOM.Notificaciones_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Notificaciones_Objetivo_Trans") realTable = OSIS.PEPPAM.BOM.Notificaciones_Objetivo_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Notificaciones_Personas_Trans") realTable = OSIS.PEPPAM.BOM.Notificaciones_Personas_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Notificaciones_Prioridades_Cata") realTable = OSIS.PEPPAM.BOM.Notificaciones_Prioridades_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Parametros_Trans") realTable = OSIS.PEPPAM.BOM.Parametros_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Persona_Contactos_Trans") realTable = OSIS.PEPPAM.BOM.Persona_Contactos_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Persona_Estado_Cata") realTable = OSIS.PEPPAM.BOM.Persona_Estado_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Persona_Roles_Trans") realTable = OSIS.PEPPAM.BOM.Persona_Roles_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Personas_Diponibilidad") realTable = OSIS.PEPPAM.BOM.Personas_Diponibilidad.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Personas_Master") realTable = OSIS.PEPPAM.BOM.Personas_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Personas_Notificaciones_Trans") realTable = OSIS.PEPPAM.BOM.Personas_Notificaciones_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Personas_Tipo_Cata") realTable = OSIS.PEPPAM.BOM.Personas_Tipo_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Personas_Tipos_Trans") realTable = OSIS.PEPPAM.BOM.Personas_Tipos_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Personas_Turnos_Trans") realTable = OSIS.PEPPAM.BOM.Personas_Turnos_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Publicaciones_Cata") realTable = OSIS.PEPPAM.BOM.Publicaciones_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Registro_Preguntas_Cata") realTable = OSIS.PEPPAM.BOM.Registro_Preguntas_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Registro_Respuestas_Cata") realTable = OSIS.PEPPAM.BOM.Registro_Respuestas_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Registro_Respueta_Categorias_Cata") realTable = OSIS.PEPPAM.BOM.Registro_Respueta_Categorias_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Roles_Cata") realTable = OSIS.PEPPAM.BOM.Roles_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Roles_Funcionalidad_Acciones_Trans") realTable = OSIS.PEPPAM.BOM.Roles_Funcionalidad_Acciones_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Roles_Niveles_Cata") realTable = OSIS.PEPPAM.BOM.Roles_Niveles_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Rutas_Master") realTable = OSIS.PEPPAM.BOM.Rutas_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistema_Correos_Enviado_Trans") realTable = OSIS.PEPPAM.BOM.Sistema_Correos_Enviado_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Correos_Cata") realTable = OSIS.PEPPAM.BOM.Sistemas_Correos_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Descripciones_Trans") realTable = OSIS.PEPPAM.BOM.Sistemas_Descripciones_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Funcionalidades_Acciones_Cata") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Funcionalidades_Acciones_Tipo_Cata") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Tipo_Cata.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Funcionalidades_Acciones_Trans") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Funcionalidades_Master") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Mensaje_Trans") realTable = OSIS.PEPPAM.BOM.Sistemas_Mensaje_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Modulos_Master") realTable = OSIS.PEPPAM.BOM.Sistemas_Modulos_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Sistemas_Slides_Master") realTable = OSIS.PEPPAM.BOM.Sistemas_Slides_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Turnos_Dias_Trans") realTable = OSIS.PEPPAM.BOM.Turnos_Dias_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Turnos_Master") realTable = OSIS.PEPPAM.BOM.Turnos_Master.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Zonas_Encargados_Trans") realTable = OSIS.PEPPAM.BOM.Zonas_Encargados_Trans.GetTableFromFieldNameSqlMapping(field);
			else if (parentTable == "Zonas_Master") realTable = OSIS.PEPPAM.BOM.Zonas_Master.GetTableFromFieldNameSqlMapping(field);
			LinqSQLFromClause sqlFromClause = this.GetByTable(realTable);
			return sqlFromClause.TableName;
		}

	}

	#endregion

	#region BusinessObjectQuery

	delegate string GetDatabaseFieldNameDelegate(string field);
	[System.CodeDom.Compiler.GeneratedCode("nHydrateModelGenerator", "5.2.0")]
	internal partial class BusinessObjectQuery<T, K, P>
		where T : class, nHydrate.EFCore.DataAccess.IBusinessObject
		where K : class, nHydrate.EFCore.DataAccess.IBusinessObjectLINQQuery
	{
		private const int DEFAULTTIMEOUT = 30;
		#region GetSum
		public static double? GetSum(
			Expression<Func<K, P>> select,
			Expression<Func<K, bool>> where,
			nHydrate.EFCore.DataAccess.QueryOptimizer optimizer,
			string leafTable,
			GetDatabaseFieldNameDelegate getField,
			LinqSQLParser.ObjectTypeConstants objectType)
		{
			var dc = new DataContext(OSIS.PEPPAM.BOM.DBHelper.GetConnection());
			var template = dc.GetTable<K>();
			var cmd = nHydrate.EFCore.DataAccess.BusinessEntityQuery.GetCommand<K, P>(dc, template, select, where);
			cmd.CommandTimeout = DEFAULTTIMEOUT;
			var parser = LinqSQLParser.Create(cmd.CommandText, objectType);
			var fieldName = parser.GetSelectClause();
			cmd.CommandText = "SELECT SUM([" + parser.GetTableAlias(fieldName, leafTable) + "]." + fieldName + ") " +
				parser.GetFromClause(optimizer) + " " +
				parser.GetWhereClause() + string.Empty;
			dc.Connection.Open();
			object p = cmd.ExecuteScalar();
			dc.Connection.Close();
			if (p == System.DBNull.Value)
				return null;
			else if (p is decimal)
				return (double?)(decimal)p;
			else if (p is int)
				return (double?)(int)p;
			else if (p is long)
				return (double?)(long)p;
			else if (p is float)
				return (double?)(float)p;
			else if (p is Single)
				return (double?)(Single)p;
			else
				return (double?)p;
		}
		#endregion

		#region GetCount
		public static P GetCount(
			Expression<Func<K, bool>> where,
			nHydrate.EFCore.DataAccess.QueryOptimizer optimizer)
		{
			var dc = new DataContext(OSIS.PEPPAM.BOM.DBHelper.GetConnection());
			var template = dc.GetTable<K>();
			var cmd = nHydrate.EFCore.DataAccess.BusinessEntityQuery.GetCommand<K>(dc, template, where);
			cmd.CommandTimeout = DEFAULTTIMEOUT;
			var parser = LinqSQLParser.Create(cmd.CommandText, LinqSQLParser.ObjectTypeConstants.Table);
			cmd.CommandText = "SELECT COUNT(*) " + parser.GetFromClause(optimizer) + " " + parser.GetWhereClause() + string.Empty;
			dc.Connection.Open();
			object p = cmd.ExecuteScalar();
			dc.Connection.Close();
			return (P)p;
		}
		#endregion

		#region GetDistinct
		public static IEnumerable<P> GetDistinct(
			Expression<Func<K, P>> select,
			Expression<Func<K, bool>> where,
			nHydrate.EFCore.DataAccess.QueryOptimizer optimizer,
			string leafTable,
			GetDatabaseFieldNameDelegate getField,
			LinqSQLParser.ObjectTypeConstants objectType)
		{
			using (var dc = new DataContext(OSIS.PEPPAM.BOM.DBHelper.GetConnection()))
			{
				var template = dc.GetTable<K>();
				var cmd = nHydrate.EFCore.DataAccess.BusinessEntityQuery.GetCommand<K, P>(dc, template, select, where);
				cmd.CommandTimeout = DEFAULTTIMEOUT;
				var parser = LinqSQLParser.Create(cmd.CommandText, objectType);
				string fieldName = parser.GetSelectClause();
				cmd.CommandText = "SELECT DISTINCT([" + parser.GetTableAlias(fieldName, leafTable) + "]." + fieldName + ") " + parser.GetFromClause(optimizer) + " " + parser.GetWhereClause() + string.Empty;
				dc.Connection.Open();
				var dr = cmd.ExecuteReader();
				var retval = new List<P>();
				while (dr.Read())
				{
					if (!dr.IsDBNull(0))
					{
						object o = dr[0];
						retval.Add((P)o);
					}
				}
				dc.Connection.Close();
				return retval;
			}
		}
		#endregion

		#region GetMin
		public static P GetMin(
			Expression<Func<K, P>> select,
			Expression<Func<K, bool>> where,
			nHydrate.EFCore.DataAccess.QueryOptimizer optimizer,
			string leafTable,
			GetDatabaseFieldNameDelegate getField,
			LinqSQLParser.ObjectTypeConstants objectType)
		{
			using (var dc = new DataContext(OSIS.PEPPAM.BOM.DBHelper.GetConnection()))
			{
				var template = dc.GetTable<K>();
				var cmd = nHydrate.EFCore.DataAccess.BusinessEntityQuery.GetCommand<K, P>(dc, template, select, where);
				cmd.CommandTimeout = DEFAULTTIMEOUT;
				var parser = LinqSQLParser.Create(cmd.CommandText, objectType);
				var fieldName = parser.GetSelectClause();
				cmd.CommandText = "SELECT MIN([" + parser.GetTableAlias(fieldName, leafTable) + "]." + fieldName + ") " +
					parser.GetFromClause(optimizer) + " " +
					parser.GetWhereClause() + string.Empty;
					dc.Connection.Open();
				object p = cmd.ExecuteScalar();
				dc.Connection.Close();
				if (p == System.DBNull.Value)
					return default(P);
				else
					return (P)p;
			}
		}
		#endregion

		#region GetMax
		public static P GetMax(
			Expression<Func<K, P>> select,
			Expression<Func<K, bool>> where,
			nHydrate.EFCore.DataAccess.QueryOptimizer optimizer,
			string leafTable,
			GetDatabaseFieldNameDelegate getField,
			LinqSQLParser.ObjectTypeConstants objectType)
		{
			using (var dc = new DataContext(OSIS.PEPPAM.BOM.DBHelper.GetConnection()))
			{
				var template = dc.GetTable<K>();
				var cmd = nHydrate.EFCore.DataAccess.BusinessEntityQuery.GetCommand<K, P>(dc, template, select, where);
				cmd.CommandTimeout = DEFAULTTIMEOUT;
				var parser = LinqSQLParser.Create(cmd.CommandText, objectType);
				string fieldName = parser.GetSelectClause();
				cmd.CommandText = "SELECT MAX([" + parser.GetTableAlias(fieldName, leafTable) + "]." + fieldName + ") " +
					parser.GetFromClause(optimizer) + " " +
					parser.GetWhereClause() + string.Empty;
				dc.Connection.Open();
				object p = cmd.ExecuteScalar();
				dc.Connection.Close();
				if (p == System.DBNull.Value)
					return default(P);
				else
					return (P)p;
			}
		}
		#endregion

		#region GetAverage
		public static P GetAverage(
			Expression<Func<K, P>> select,
			Expression<Func<K, bool>> where,
			nHydrate.EFCore.DataAccess.QueryOptimizer optimizer,
			string leafTable,
			GetDatabaseFieldNameDelegate getField,
			LinqSQLParser.ObjectTypeConstants objectType)
		{
			using (var dc = new DataContext(OSIS.PEPPAM.BOM.DBHelper.GetConnection()))
			{
				var template = dc.GetTable<K>();
				var cmd = nHydrate.EFCore.DataAccess.BusinessEntityQuery.GetCommand<K, P>(dc, template, select, where);
				cmd.CommandTimeout = DEFAULTTIMEOUT;
				var parser = LinqSQLParser.Create(cmd.CommandText, objectType);
				var fieldName = parser.GetSelectClause();
				cmd.CommandText = "SELECT AVG([" + parser.GetTableAlias(fieldName, leafTable) + "]." + fieldName + ") " +
					parser.GetFromClause(optimizer) + " " +
					parser.GetWhereClause() + string.Empty;
				dc.Connection.Open();
				object p = cmd.ExecuteScalar();
				dc.Connection.Close();
				if (p == System.DBNull.Value)
					return default(P);
				else
					return (P)p;
			}
		}
		#endregion


	}

	#endregion

	#region LinqSQLParser

	[System.CodeDom.Compiler.GeneratedCode("nHydrateModelGenerator", "5.2.0")]
	internal partial class LinqSQLParser
	{

		internal enum ObjectTypeConstants
		{
			Table,
			View,
			StoredProcedure,
		}

		#region Static Creator

		public static LinqSQLParser Create(string sql, ObjectTypeConstants type)
		{
			return new LinqSQLParser(sql, type);
		}

		public static LinqSQLParser Create(string sql, object paging, ObjectTypeConstants type)
		{
			return new LinqSQLParser(sql, paging, type);
		}

		#endregion

		#region Class Members

		private object _paging = null;
		private string _whereClause = string.Empty;
		private string _sql = string.Empty;
		private LinqSQLFromClauseCollection _fromLinkList = new LinqSQLFromClauseCollection();
		private List<LinqSQLField> _fieldList = new List<LinqSQLField>();
		private ObjectTypeConstants _type;

		#endregion

		#region Constructor

		private LinqSQLParser(string sql, object paging, ObjectTypeConstants type)
			: this(sql, type)
		{
			_type = type;
			_paging = paging;
		}

		private LinqSQLParser(string sql, ObjectTypeConstants type)
		{
			if ((sql == null) || (sql == string.Empty))
				throw new Exception("SQL cannot be empty.");

			_type = type;
			_sql = sql;

			//Parse the string into SELECT, FROM, WHERE
			int index = sql.IndexOf("\r\nFROM") + 2;
			string selectClause = sql.Substring(0, index).Replace("\r\n", " ");
			index = sql.IndexOf("\r\nWHERE");
			if (index == -1) index = sql.Length;
			string fromClause = sql.Substring(selectClause.Length - 1, index - selectClause.Length + 1).Replace("\r\n", " ").Trim();
			fromClause = fromClause.Substring(5, fromClause.Length - 5).Trim();
			selectClause = selectClause.Trim();
			fromClause = fromClause.Trim();

			index = sql.IndexOf("\r\nWHERE");
			if (index != -1)
			{
				_whereClause = sql.Substring(index + 2, sql.Length - index - 2).Replace("\r\n", " ");
				_whereClause = _whereClause.Substring(6, _whereClause.Length - 6);
			}

			ParseFrom(fromClause);
			ParseSelect(selectClause);
			RemapParentChild();

		}

		#endregion

		#region RemapTenantToAdminSql

		internal static string RemapTenantToAdminSql(string sql)
		{
			if (string.IsNullOrEmpty(sql)) return sql;
			return sql;
		}

		#endregion
		#region RemapParentChild

		private void RemapParentChild()
		{
			//Include all base tables
			LinqSQLFromClauseCollection childTables = new LinqSQLFromClauseCollection();
			foreach (var fromClause in _fromLinkList)
			{
				//Do all field replacements
				if (_type == ObjectTypeConstants.Table)
				{
					if (fromClause.TableName == "Circuitos_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Congregaciones_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Contacto_Tipo_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Dias_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Documentos_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Documentos_Objetivos_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Experiencias_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Horario_Semanas_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Horario_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Horario_Turno_Dias_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Horario_Turno_Informe_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Horario_Turno_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Horarios_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Horas_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Idiomas_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Notificaciones_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Notificaciones_Objetivo_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Notificaciones_Personas_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Notificaciones_Prioridades_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Parametros_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Persona_Contactos_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Persona_Estado_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Persona_Roles_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Personas_Diponibilidad")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Personas_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Personas_Notificaciones_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Personas_Tipo_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Personas_Tipos_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Personas_Turnos_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Publicaciones_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Registro_Preguntas_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Registro_Respuestas_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Registro_Respueta_Categorias_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Roles_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Roles_Funcionalidad_Acciones_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Roles_Niveles_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Rutas_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistema_Correos_Enviado_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Correos_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Descripciones_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Funcionalidades_Acciones_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Funcionalidades_Acciones_Tipo_Cata")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Funcionalidades_Acciones_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Funcionalidades_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Mensaje_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Modulos_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Sistemas_Slides_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Turnos_Dias_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Turnos_Master")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Zonas_Encargados_Trans")
					{
						childTables.Add(fromClause);
					}
					if (fromClause.TableName == "Zonas_Master")
					{
						childTables.Add(fromClause);
					}
				}
				if (_type == ObjectTypeConstants.View)
				{
				}
			}
			_fromLinkList.Clear();
			_fromLinkList.AddRange(childTables);

			//Process the FROM clause
			_fromLinkList.RemapFromClause();

			//Now map the columns to the proper tables
			foreach (var field in _fieldList)
			{
				LinqSQLFromClause clause = _fromLinkList.FirstOrDefault(x => x.Alias == field.Table);
				string realTable = string.Empty;
				if (_type == ObjectTypeConstants.Table)
				{
					if (clause.TableName == "Circuitos_Cata") realTable = OSIS.PEPPAM.BOM.Circuitos_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Congregaciones_Master") realTable = OSIS.PEPPAM.BOM.Congregaciones_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Contacto_Tipo_Cata") realTable = OSIS.PEPPAM.BOM.Contacto_Tipo_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Dias_Cata") realTable = OSIS.PEPPAM.BOM.Dias_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Documentos_Master") realTable = OSIS.PEPPAM.BOM.Documentos_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Documentos_Objetivos_Trans") realTable = OSIS.PEPPAM.BOM.Documentos_Objetivos_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Experiencias_Master") realTable = OSIS.PEPPAM.BOM.Experiencias_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Horario_Semanas_Cata") realTable = OSIS.PEPPAM.BOM.Horario_Semanas_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Horario_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Horario_Turno_Dias_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Turno_Dias_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Horario_Turno_Informe_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Turno_Informe_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Horario_Turno_Trans") realTable = OSIS.PEPPAM.BOM.Horario_Turno_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Horarios_Master") realTable = OSIS.PEPPAM.BOM.Horarios_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Horas_Cata") realTable = OSIS.PEPPAM.BOM.Horas_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Idiomas_Cata") realTable = OSIS.PEPPAM.BOM.Idiomas_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Notificaciones_Master") realTable = OSIS.PEPPAM.BOM.Notificaciones_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Notificaciones_Objetivo_Trans") realTable = OSIS.PEPPAM.BOM.Notificaciones_Objetivo_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Notificaciones_Personas_Trans") realTable = OSIS.PEPPAM.BOM.Notificaciones_Personas_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Notificaciones_Prioridades_Cata") realTable = OSIS.PEPPAM.BOM.Notificaciones_Prioridades_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Parametros_Trans") realTable = OSIS.PEPPAM.BOM.Parametros_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Persona_Contactos_Trans") realTable = OSIS.PEPPAM.BOM.Persona_Contactos_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Persona_Estado_Cata") realTable = OSIS.PEPPAM.BOM.Persona_Estado_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Persona_Roles_Trans") realTable = OSIS.PEPPAM.BOM.Persona_Roles_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Personas_Diponibilidad") realTable = OSIS.PEPPAM.BOM.Personas_Diponibilidad.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Personas_Master") realTable = OSIS.PEPPAM.BOM.Personas_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Personas_Notificaciones_Trans") realTable = OSIS.PEPPAM.BOM.Personas_Notificaciones_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Personas_Tipo_Cata") realTable = OSIS.PEPPAM.BOM.Personas_Tipo_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Personas_Tipos_Trans") realTable = OSIS.PEPPAM.BOM.Personas_Tipos_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Personas_Turnos_Trans") realTable = OSIS.PEPPAM.BOM.Personas_Turnos_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Publicaciones_Cata") realTable = OSIS.PEPPAM.BOM.Publicaciones_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Registro_Preguntas_Cata") realTable = OSIS.PEPPAM.BOM.Registro_Preguntas_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Registro_Respuestas_Cata") realTable = OSIS.PEPPAM.BOM.Registro_Respuestas_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Registro_Respueta_Categorias_Cata") realTable = OSIS.PEPPAM.BOM.Registro_Respueta_Categorias_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Roles_Cata") realTable = OSIS.PEPPAM.BOM.Roles_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Roles_Funcionalidad_Acciones_Trans") realTable = OSIS.PEPPAM.BOM.Roles_Funcionalidad_Acciones_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Roles_Niveles_Cata") realTable = OSIS.PEPPAM.BOM.Roles_Niveles_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Rutas_Master") realTable = OSIS.PEPPAM.BOM.Rutas_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistema_Correos_Enviado_Trans") realTable = OSIS.PEPPAM.BOM.Sistema_Correos_Enviado_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Correos_Cata") realTable = OSIS.PEPPAM.BOM.Sistemas_Correos_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Descripciones_Trans") realTable = OSIS.PEPPAM.BOM.Sistemas_Descripciones_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Funcionalidades_Acciones_Cata") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Funcionalidades_Acciones_Tipo_Cata") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Tipo_Cata.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Funcionalidades_Acciones_Trans") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Funcionalidades_Master") realTable = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Mensaje_Trans") realTable = OSIS.PEPPAM.BOM.Sistemas_Mensaje_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Modulos_Master") realTable = OSIS.PEPPAM.BOM.Sistemas_Modulos_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Sistemas_Slides_Master") realTable = OSIS.PEPPAM.BOM.Sistemas_Slides_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Turnos_Dias_Trans") realTable = OSIS.PEPPAM.BOM.Turnos_Dias_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Turnos_Master") realTable = OSIS.PEPPAM.BOM.Turnos_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Zonas_Encargados_Trans") realTable = OSIS.PEPPAM.BOM.Zonas_Encargados_Trans.GetTableFromFieldAliasSqlMapping(field.Alias);
					else if (clause.TableName == "Zonas_Master") realTable = OSIS.PEPPAM.BOM.Zonas_Master.GetTableFromFieldAliasSqlMapping(field.Alias);
				}
				var sqlFromClause = _fromLinkList.GetByTable(realTable);
				field.Table = sqlFromClause.Alias;
			}

			//Calculate the WHERE clause
			if (!string.IsNullOrEmpty(_whereClause))
			{
				foreach (var fromClause in _fromLinkList)
				{
					//Only process table that were original and not inserted above
					if (fromClause.AnchorAlias == string.Empty)
						_whereClause = GetRemappedLinqSql(fromClause, _whereClause, _fromLinkList, _type);
				}

			}

		}

		public static string GetRemappedLinqSql(LinqSQLFromClause tableInfo, string whereClause, LinqSQLFromClauseCollection fromLinkList, ObjectTypeConstants type)
		{
			if (type == ObjectTypeConstants.Table)
			{
				switch (tableInfo.TableName)
				{
					case "Circuitos_Cata": return OSIS.PEPPAM.BOM.Circuitos_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Congregaciones_Master": return OSIS.PEPPAM.BOM.Congregaciones_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Contacto_Tipo_Cata": return OSIS.PEPPAM.BOM.Contacto_Tipo_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Dias_Cata": return OSIS.PEPPAM.BOM.Dias_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Documentos_Master": return OSIS.PEPPAM.BOM.Documentos_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Documentos_Objetivos_Trans": return OSIS.PEPPAM.BOM.Documentos_Objetivos_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Experiencias_Master": return OSIS.PEPPAM.BOM.Experiencias_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Horario_Semanas_Cata": return OSIS.PEPPAM.BOM.Horario_Semanas_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Horario_Trans": return OSIS.PEPPAM.BOM.Horario_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Horario_Turno_Dias_Trans": return OSIS.PEPPAM.BOM.Horario_Turno_Dias_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Horario_Turno_Informe_Trans": return OSIS.PEPPAM.BOM.Horario_Turno_Informe_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Horario_Turno_Trans": return OSIS.PEPPAM.BOM.Horario_Turno_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Horarios_Master": return OSIS.PEPPAM.BOM.Horarios_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Horas_Cata": return OSIS.PEPPAM.BOM.Horas_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Idiomas_Cata": return OSIS.PEPPAM.BOM.Idiomas_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Notificaciones_Master": return OSIS.PEPPAM.BOM.Notificaciones_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Notificaciones_Objetivo_Trans": return OSIS.PEPPAM.BOM.Notificaciones_Objetivo_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Notificaciones_Personas_Trans": return OSIS.PEPPAM.BOM.Notificaciones_Personas_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Notificaciones_Prioridades_Cata": return OSIS.PEPPAM.BOM.Notificaciones_Prioridades_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Parametros_Trans": return OSIS.PEPPAM.BOM.Parametros_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Persona_Contactos_Trans": return OSIS.PEPPAM.BOM.Persona_Contactos_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Persona_Estado_Cata": return OSIS.PEPPAM.BOM.Persona_Estado_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Persona_Roles_Trans": return OSIS.PEPPAM.BOM.Persona_Roles_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Personas_Diponibilidad": return OSIS.PEPPAM.BOM.Personas_Diponibilidad.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Personas_Master": return OSIS.PEPPAM.BOM.Personas_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Personas_Notificaciones_Trans": return OSIS.PEPPAM.BOM.Personas_Notificaciones_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Personas_Tipo_Cata": return OSIS.PEPPAM.BOM.Personas_Tipo_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Personas_Tipos_Trans": return OSIS.PEPPAM.BOM.Personas_Tipos_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Personas_Turnos_Trans": return OSIS.PEPPAM.BOM.Personas_Turnos_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Publicaciones_Cata": return OSIS.PEPPAM.BOM.Publicaciones_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Registro_Preguntas_Cata": return OSIS.PEPPAM.BOM.Registro_Preguntas_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Registro_Respuestas_Cata": return OSIS.PEPPAM.BOM.Registro_Respuestas_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Registro_Respueta_Categorias_Cata": return OSIS.PEPPAM.BOM.Registro_Respueta_Categorias_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Roles_Cata": return OSIS.PEPPAM.BOM.Roles_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Roles_Funcionalidad_Acciones_Trans": return OSIS.PEPPAM.BOM.Roles_Funcionalidad_Acciones_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Roles_Niveles_Cata": return OSIS.PEPPAM.BOM.Roles_Niveles_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Rutas_Master": return OSIS.PEPPAM.BOM.Rutas_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistema_Correos_Enviado_Trans": return OSIS.PEPPAM.BOM.Sistema_Correos_Enviado_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Correos_Cata": return OSIS.PEPPAM.BOM.Sistemas_Correos_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Descripciones_Trans": return OSIS.PEPPAM.BOM.Sistemas_Descripciones_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Funcionalidades_Acciones_Cata": return OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Funcionalidades_Acciones_Tipo_Cata": return OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Tipo_Cata.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Funcionalidades_Acciones_Trans": return OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Funcionalidades_Master": return OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Mensaje_Trans": return OSIS.PEPPAM.BOM.Sistemas_Mensaje_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Modulos_Master": return OSIS.PEPPAM.BOM.Sistemas_Modulos_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Sistemas_Slides_Master": return OSIS.PEPPAM.BOM.Sistemas_Slides_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Turnos_Dias_Trans": return OSIS.PEPPAM.BOM.Turnos_Dias_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Turnos_Master": return OSIS.PEPPAM.BOM.Turnos_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Zonas_Encargados_Trans": return OSIS.PEPPAM.BOM.Zonas_Encargados_Trans.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
					case "Zonas_Master": return OSIS.PEPPAM.BOM.Zonas_Master.GetRemappedLinqSql(whereClause, tableInfo.Alias, fromLinkList);
				}
			}
			if (type == ObjectTypeConstants.View)
			{
			}
			if (type == ObjectTypeConstants.StoredProcedure)
			{
			}
			throw new Exception("Table not found '" + tableInfo.TableName + "'.");
		}

		#endregion

		#region ParseFrom

		private void ParseFrom(string fromClause)
		{
			const string LINKSQL = "LEFT OUTER JOIN ";
			var fromArray = fromClause.Split(new string[] { LINKSQL }, StringSplitOptions.RemoveEmptyEntries);
			var index = fromArray[0].IndexOf("]");
			var tableName = fromArray[0].Substring(1, index - 1);

			_fromLinkList.Add(new LinqSQLFromClause(tableName, GetSchema(tableName), "t0", string.Empty));

			for (int ii = 1; ii < fromArray.Length; ii++)
			{
				var rawText = fromArray[ii];

				//Get Table
				index = rawText.IndexOf("]");
				var table = rawText.Substring(0, index + 1);
				rawText = rawText.Substring(table.Length + 4, rawText.Length - table.Length - 4);

				//Get Alias
				index = rawText.IndexOf("]");
				var alias = rawText.Substring(0, index + 1);

				//Get Link
				var linkClause = rawText.Substring(alias.Length + 1, rawText.Length - alias.Length - 1);

				_fromLinkList.Add(new LinqSQLFromClause(table, GetSchema(table), alias, linkClause));
			}
		}

		#endregion

		#region ParseSelect

		private void ParseSelect(string selectClause)
		{
			//Parse fields
			var selectList = selectClause.Substring(7, selectClause.Length - 7).Split(',');
			foreach (string rawField in selectList)
			{
				var s = rawField.Trim();

				//Get Table
				var index = s.IndexOf("]");
				var table = s.Substring(0, index + 1);
				s = s.Substring(table.Length + 1, s.Length - table.Length - 1);

				//Get Name
				index = s.IndexOf("]");
				var field = s.Substring(0, index + 1);

				//Get Alias
				var alias = field;
				bool hasAlias = false;
				if (s.Length > field.Length)
				{
					alias = s.Substring(field.Length + 4, s.Length - field.Length - 4);
					hasAlias = true;
				}

				if (!hasAlias)
				{
					LinqSQLFromClause clause = _fromLinkList.FirstOrDefault(x => x.Alias == table.Replace("[", string.Empty).Replace("]", string.Empty));
					switch (clause.TableName)
					{
						case "Circuitos_Cata": alias = OSIS.PEPPAM.BOM.Circuitos_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Congregaciones_Master": alias = OSIS.PEPPAM.BOM.Congregaciones_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Contacto_Tipo_Cata": alias = OSIS.PEPPAM.BOM.Contacto_Tipo_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Dias_Cata": alias = OSIS.PEPPAM.BOM.Dias_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Documentos_Master": alias = OSIS.PEPPAM.BOM.Documentos_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Documentos_Objetivos_Trans": alias = OSIS.PEPPAM.BOM.Documentos_Objetivos_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Experiencias_Master": alias = OSIS.PEPPAM.BOM.Experiencias_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Horario_Semanas_Cata": alias = OSIS.PEPPAM.BOM.Horario_Semanas_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Horario_Trans": alias = OSIS.PEPPAM.BOM.Horario_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Horario_Turno_Dias_Trans": alias = OSIS.PEPPAM.BOM.Horario_Turno_Dias_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Horario_Turno_Informe_Trans": alias = OSIS.PEPPAM.BOM.Horario_Turno_Informe_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Horario_Turno_Trans": alias = OSIS.PEPPAM.BOM.Horario_Turno_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Horarios_Master": alias = OSIS.PEPPAM.BOM.Horarios_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Horas_Cata": alias = OSIS.PEPPAM.BOM.Horas_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Idiomas_Cata": alias = OSIS.PEPPAM.BOM.Idiomas_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Notificaciones_Master": alias = OSIS.PEPPAM.BOM.Notificaciones_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Notificaciones_Objetivo_Trans": alias = OSIS.PEPPAM.BOM.Notificaciones_Objetivo_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Notificaciones_Personas_Trans": alias = OSIS.PEPPAM.BOM.Notificaciones_Personas_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Notificaciones_Prioridades_Cata": alias = OSIS.PEPPAM.BOM.Notificaciones_Prioridades_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Parametros_Trans": alias = OSIS.PEPPAM.BOM.Parametros_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Persona_Contactos_Trans": alias = OSIS.PEPPAM.BOM.Persona_Contactos_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Persona_Estado_Cata": alias = OSIS.PEPPAM.BOM.Persona_Estado_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Persona_Roles_Trans": alias = OSIS.PEPPAM.BOM.Persona_Roles_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Personas_Diponibilidad": alias = OSIS.PEPPAM.BOM.Personas_Diponibilidad.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Personas_Master": alias = OSIS.PEPPAM.BOM.Personas_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Personas_Notificaciones_Trans": alias = OSIS.PEPPAM.BOM.Personas_Notificaciones_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Personas_Tipo_Cata": alias = OSIS.PEPPAM.BOM.Personas_Tipo_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Personas_Tipos_Trans": alias = OSIS.PEPPAM.BOM.Personas_Tipos_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Personas_Turnos_Trans": alias = OSIS.PEPPAM.BOM.Personas_Turnos_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Publicaciones_Cata": alias = OSIS.PEPPAM.BOM.Publicaciones_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Registro_Preguntas_Cata": alias = OSIS.PEPPAM.BOM.Registro_Preguntas_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Registro_Respuestas_Cata": alias = OSIS.PEPPAM.BOM.Registro_Respuestas_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Registro_Respueta_Categorias_Cata": alias = OSIS.PEPPAM.BOM.Registro_Respueta_Categorias_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Roles_Cata": alias = OSIS.PEPPAM.BOM.Roles_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Roles_Funcionalidad_Acciones_Trans": alias = OSIS.PEPPAM.BOM.Roles_Funcionalidad_Acciones_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Roles_Niveles_Cata": alias = OSIS.PEPPAM.BOM.Roles_Niveles_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Rutas_Master": alias = OSIS.PEPPAM.BOM.Rutas_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistema_Correos_Enviado_Trans": alias = OSIS.PEPPAM.BOM.Sistema_Correos_Enviado_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Correos_Cata": alias = OSIS.PEPPAM.BOM.Sistemas_Correos_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Descripciones_Trans": alias = OSIS.PEPPAM.BOM.Sistemas_Descripciones_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Funcionalidades_Acciones_Cata": alias = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Funcionalidades_Acciones_Tipo_Cata": alias = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Tipo_Cata.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Funcionalidades_Acciones_Trans": alias = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Acciones_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Funcionalidades_Master": alias = OSIS.PEPPAM.BOM.Sistemas_Funcionalidades_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Mensaje_Trans": alias = OSIS.PEPPAM.BOM.Sistemas_Mensaje_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Modulos_Master": alias = OSIS.PEPPAM.BOM.Sistemas_Modulos_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Sistemas_Slides_Master": alias = OSIS.PEPPAM.BOM.Sistemas_Slides_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Turnos_Dias_Trans": alias = OSIS.PEPPAM.BOM.Turnos_Dias_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Turnos_Master": alias = OSIS.PEPPAM.BOM.Turnos_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Zonas_Encargados_Trans": alias = OSIS.PEPPAM.BOM.Zonas_Encargados_Trans.GetFieldAliasFromFieldNameSqlMapping(field); break;
						case "Zonas_Master": alias = OSIS.PEPPAM.BOM.Zonas_Master.GetFieldAliasFromFieldNameSqlMapping(field); break;
					}
				}

				_fieldList.Add(new LinqSQLField(field, alias, table));
			}

		}

		#endregion

		#region Methods

		public string GetSchema(string tableName)
		{
			//There is only one schema for this API, so just hard-wire it
			return "dbo";
		}

		public string GetSelectClause()
		{
			var sb = new StringBuilder();
			foreach (var field in _fieldList)
			{
				sb.Append(field.Name);
				if (_fieldList.IndexOf(field) < _fieldList.Count - 1)
					sb.Append(", ");
			}
			return sb.ToString();
		}

		public string GetFromClause(nHydrate.EFCore.DataAccess.QueryOptimizer optimizer)
		{
			var sb = new StringBuilder();

			//Calculate the FROM clause
			int index = 0;
			sb.Append("FROM ");
			foreach (var fromClause in _fromLinkList)
			{
				sb.Append("[" + fromClause.Schema + "].[" + fromClause.TableName + "] AS [" + fromClause.Alias + "] ");
				if (optimizer.NoLocking) sb.Append("WITH (NOLOCK) ");
				if (!string.IsNullOrEmpty(fromClause.LinkClause)) sb.Append(fromClause.LinkClause + " ");

				if (index < _fromLinkList.Count - 1)
				{
					sb.AppendLine();
					sb.Append("LEFT OUTER JOIN ");
				}

				index++;
			}
			sb.AppendLine();
			return sb.ToString();
		}

		public string GetWhereClause()
		{
			if (!string.IsNullOrEmpty(_whereClause)) return "WHERE " + _whereClause;
			else return string.Empty;
		}

		public string GetTableAlias(string fieldName, string tableName)
		{
			return (from x in _fieldList where x.Name == fieldName select x).FirstOrDefault().Table;
		}

		#endregion

		#region GetTextFromResource

		public static string GetTextFromResource(string resourceFileName)
		{
			try
			{
				var sb = new StringBuilder();
				var asm = Assembly.GetExecutingAssembly();
				var manifestStream = asm.GetManifestResourceStream(resourceFileName);
				try
				{
					var theReader = new BinaryReader(manifestStream);
					var theFileRead = new byte[manifestStream.Length];
					manifestStream.Read(theFileRead, 0, theFileRead.Length);
					var data = Encoding.ASCII.GetString(theFileRead);
					theReader.Close();
					return data;
				}
				catch { }
				finally
				{
					manifestStream.Close();
				}
				return string.Empty;
			}
			catch
			{
				throw;
			}
		}

		#endregion

	}

	#endregion

	[System.CodeDom.Compiler.GeneratedCode("nHydrateModelGenerator", "5.2.0")]
	internal static class GlobalValues
	{
		public const string ERROR_PROPERTY_NULL = "The value is null and in an invalid state.";
		public const string ERROR_PROPERTY_SETNULL = "Cannot set value to null.";
		public const string ERROR_CONCURRENCY_FAILURE = "Concurrency failure";
		public const string ERROR_CONSTRAINT_FAILURE = "Constraint failure";
		public const string ERROR_DATA_TOO_BIG = "The data '{0}' is too large for the {1} field which has a length of {2}.";
		public const string ERROR_INVALID_ENUM = "The value '{0}' set to the '{1}' field is not valid based on the backing enumeration.";
		public static readonly DateTime MIN_DATETIME = new DateTime(1753, 1, 1);
		public static readonly DateTime MAX_DATETIME = new DateTime(9999, 12, 31, 23, 59, 59);
		private const string INVALID_BUSINIESSOBJECT = "An invalid object of type 'IBusinessObject' was passed in. Perhaps a relationship was not enforced correctly.";

		internal static string SetValueHelperInternal(string newValue, bool fixLength, int maxDataLength)
		{
			string retval = null;
			if (newValue == null)
			{
				retval = null;
			}
			else
			{
				var v = newValue.ToString();
				if (fixLength)
				{
					int fieldLength = maxDataLength;
					if ((fieldLength > 0) && (v.Length > fieldLength)) v = v.Substring(0, fieldLength);
				}
				retval = v;
			}
			return retval;
		}

		internal static double? SetValueHelperDoubleNullableInternal(object newValue)
		{
			double? retval;
			if (newValue == null)
			{
				retval = null;
			}
			else
			{
				if (newValue is string)
				{
					retval = double.Parse((string)newValue);
				}
				else if (!(newValue is double?))
				{
					retval = double.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (double?)newValue;
			}
			return retval;
		}

		internal static double SetValueHelperDoubleNotNullableInternal(object newValue, string nullMessage)
		{
			double retval;
			if (newValue == null)
			{
				throw new Exception(nullMessage);
			}
			else
			{
				if (newValue is string)
				{
					retval = double.Parse((string)newValue);
				}
				else if (!(newValue is double))
				{
					retval = double.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (double)newValue;
			}
			return retval;
		}

		internal static DateTime? SetValueHelperDateTimeNullableInternal(object newValue)
		{
			DateTime? retval;
			if (newValue == null)
			{
				retval = null;
			}
			else
			{
				if (newValue is string)
				{
					retval = DateTime.Parse((string)newValue);
				}
				else if (!(newValue is DateTime?))
				{
					retval = DateTime.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (DateTime?)newValue;
			}
			return retval;
		}

		internal static DateTime SetValueHelperDateTimeNotNullableInternal(object newValue, string nullMessage)
		{
			DateTime retval;
			if (newValue == null)
			{
				throw new Exception(nullMessage);
			}
			else
			{
				if (newValue is string)
				{
					retval = DateTime.Parse((string)newValue);
				}
				else if (!(newValue is DateTime))
				{
					retval = DateTime.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (DateTime)newValue;
			}
			return retval;
		}

		internal static bool? SetValueHelperBoolNullableInternal(object newValue)
		{
			bool? retval;
			if (newValue == null)
			{
				retval = null;
			}
			else
			{
				if (newValue is string)
				{
					retval = bool.Parse((string)newValue);
				}
				else if (!(newValue is bool?))
				{
					retval = bool.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (bool?)newValue;
			}
			return retval;
		}

		internal static bool SetValueHelperBoolNotNullableInternal(object newValue, string nullMessage)
		{
			bool retval;
			if (newValue == null)
			{
				throw new Exception(nullMessage);
			}
			else
			{
				if (newValue is string)
				{
					retval = bool.Parse((string)newValue);
				}
				else if (!(newValue is bool))
				{
					retval = bool.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (bool)newValue;
			}
			return retval;
		}

		internal static int? SetValueHelperIntNullableInternal(object newValue)
		{
			int? retval;
			if (newValue == null)
			{
				retval = null;
			}
			else
			{
				if (newValue is string)
				{
					retval = int.Parse((string)newValue);
				}
				else if (!(newValue is int?))
				{
					retval = int.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (int?)newValue;
			}
			return retval;
		}

		internal static int SetValueHelperIntNotNullableInternal(object newValue, string nullMessage)
		{
			int retval;
			if (newValue == null)
			{
				throw new Exception(nullMessage);
			}
			else
			{
				if (newValue is string)
				{
					retval = int.Parse((string)newValue);
				}
				else if (!(newValue is int))
				{
					retval = int.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (int)newValue;
			}
			return retval;
		}

		internal static long? SetValueHelperLongNullableInternal(object newValue)
		{
			long? retval;
			if (newValue == null)
			{
				retval = null;
			}
			else
			{
				if (newValue is string)
				{
					retval = long.Parse((string)newValue);
				}
				else if (!(newValue is long?))
				{
					retval = long.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (long?)newValue;
			}
			return retval;
		}

		internal static long SetValueHelperLongNotNullableInternal(object newValue, string nullMessage)
		{
			long retval;
			if (newValue == null)
			{
				throw new Exception(nullMessage);
			}
			else
			{
				if (newValue is string)
				{
					retval = long.Parse((string)newValue);
				}
				else if (!(newValue is long))
				{
					retval = long.Parse(newValue.ToString());
				}
				else if (newValue is nHydrate.EFCore.DataAccess.IBusinessObject)
				{
					throw new Exception(INVALID_BUSINIESSOBJECT);
				}
				else
					retval = (long)newValue;
			}
			return retval;
		}

		internal static T PropertyGetterLambdaErrorHandler<T>(Func<T> func)
		{
			try
			{
				return func();
			}
			catch (System.Data.DBConcurrencyException dbcex) { throw new ConcurrencyException(GlobalValues.ERROR_CONCURRENCY_FAILURE, dbcex); }
			catch (System.Data.SqlClient.SqlException sqlexp) { if (sqlexp.Number == 547 || sqlexp.Number == 2627) throw new UniqueConstraintViolatedException(GlobalValues.ERROR_CONSTRAINT_FAILURE, sqlexp); else throw; }
			catch (Exception ex) { System.Diagnostics.Debug.WriteLine(ex.ToString()); throw; }
		}

		internal static void PropertySetterLambdaErrorHandler(System.Action action)
		{
			try
			{
				action();
			}
			catch (System.Data.DBConcurrencyException dbcex) { throw new ConcurrencyException(GlobalValues.ERROR_CONCURRENCY_FAILURE, dbcex); }
			catch (System.Data.SqlClient.SqlException sqlexp) { if (sqlexp.Number == 547 || sqlexp.Number == 2627) throw new UniqueConstraintViolatedException(GlobalValues.ERROR_CONSTRAINT_FAILURE, sqlexp); else throw; }
			catch (Exception ex) { System.Diagnostics.Debug.WriteLine(ex.ToString()); throw; }
		}

	}

	[System.CodeDom.Compiler.GeneratedCode("nHydrateModelGenerator", "5.2.0")]
	internal static class Extensions
	{
		public static bool Contains(this DataRelationCollection relationList, DataRelation relation)
		{
			foreach (DataRelation r in relationList)
			{
				int matches = 0;
				foreach (DataColumn c in r.ChildColumns)
				{
					if (relation.ChildColumns.Contains(c))
						matches++;
				}

				foreach (DataColumn c in r.ParentColumns)
				{
					if (relation.ParentColumns.Contains(c))
						matches++;
				}

				if (r.ChildColumns.Length == (matches * 2))
					return true;

			}
			return false;
		}
	}

}
